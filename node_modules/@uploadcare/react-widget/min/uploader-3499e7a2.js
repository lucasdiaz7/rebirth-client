import{_ as e,a as n,b as r,c as t,d as a}from"./index-4702f797.js";import o,{useEffect as u,useRef as l,useCallback as c,useImperativeHandle as i}from"react";import s from"uploadcare-widget/uploadcare.min";import{u as d,a as f,b as p}from"./use-deep-effect-5fac1699.js";import C from"react-fast-compare";import"@uploadcare/client-suspense";var A=["id","name","value","onFileSelect","onChange","onDialogOpen","onDialogClose","onTabChange","apiRef","customTabs","validators","tabsCss","locale","localeTranslations","localePluralize","previewUrlCallback"];var L=function(s,L){var v=s.id,m=s.name,g=s.value,E=s.onFileSelect,O=s.onChange,w=s.onDialogOpen,R=s.onDialogClose,D=s.onTabChange,U=s.apiRef,_=s.customTabs,b=s.validators,P=s.tabsCss,h=s.locale,T=s.localeTranslations,I=s.localePluralize,S=s.previewUrlCallback,j=n(s,A),x=l(null),y=l(null),z=l(null),N=d(E),W=d(O),Z=d(w),k=d(R),B=d(D);f(_,L);var F=function(e,n){var r=!0,t=l();t.current?r=!!(n&&t.current.deps&&C(n,t.current.deps)):t.current={deps:n,result:e()};var a=r?t.current:{deps:n,result:e()};return t.current=a,a.result}((function(){return e=j,Object.entries(e).reduce((function(e,n){var o=r(n,2),u=o[0],l=o[1];return t(t({},e),{},a({},"data-".concat(u.replace(/([a-zA-Z])(?=[A-Z])/g,"$1-").toLowerCase()),l))}),{});var e}),[j]);return p((function(){return h&&(window.UPLOADCARE_LOCALE=h),I&&(window.UPLOADCARE_LOCALE_PLURALIZE=I),T&&(window.UPLOADCARE_LOCALE_TRANSLATIONS=T),S&&(window.UPLOADCARE_PREVIEW_URL_CALLBACK=S),L.plugin((function(e){e.locale.rebuild({locale:h||null,localeTranslations:T||null,localePluralize:I||null})})),function(){h&&delete window.UPLOADCARE_LOCALE,I&&delete window.UPLOADCARE_LOCALE_PLURALIZE,T&&delete window.UPLOADCARE_LOCALE_TRANSLATIONS,S&&delete window.UPLOADCARE_PREVIEW_URL_CALLBACK}}),[h,T,I,S]),u((function(){var e=x.current;y.current=L.Widget(e);var n=e.nextSibling;return z.current&&y.current.value(z.current),function(){L.jQuery(e).removeData("uploadcareWidget"),n&&n.remove()}}),[L,F]),function(e,n){u((function(){if(null!=n){var r=e.current;return n.forEach((function(e){r.validators.push(e)})),function(){r.validators.length=0}}}),[e,n])}(y,b),u((function(){return y.current.onUploadComplete.add(W),y.current.onChange.add(N),function(){y.current.onUploadComplete.remove(W),y.current.onChange.remove(N)}}),[W,N,L,F]),u((function(){var e,n=function(n){(e=n).done(k).fail(k).progress(B),Z(n)};return y.current.onDialogOpen.add(n),function(){y.current.onDialogOpen.remove(n),e&&e.reject()}}),[F,k,Z,B]),u((function(){var e=[],n=function(n){e=n?n.files?n.files():[n]:[]};return y.current.onChange.add(n),function(){e.forEach((function(e){return e.cancel()})),y.current.onChange.remove(n)}}),[F]),u((function(){z.current!==g&&y.current.value(g),z.current=g}),[g]),u((function(){L&&P&&"string"==typeof P&&(0===P.indexOf("https://")?L.tabsCss.addUrl(P):L.tabsCss.addStyle(P))}),[L,P]),i(U,(function(){return{openDialog:function(){return y.current.openDialog()},reloadInfo:function(){return y.current.reloadInfo()},getInput:function(){return y.current.inputElement}}}),[]),c((function(){return o.createElement("input",e({type:"hidden",ref:x,id:v,name:m},F))}),[F,v,m])},v=function(e){var n=L(e,s);return o.createElement(n,null)};export{v as default};
