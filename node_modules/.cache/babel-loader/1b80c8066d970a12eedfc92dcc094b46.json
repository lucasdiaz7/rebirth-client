{"ast":null,"code":"var request = require('request');\n\nvar Promise = require('bluebird');\n\nvar uuid = require('uuid');\n\nvar configurations = require('./configurations');\n\nvar MercadopagoResponse = require('./utils/mercadopagoResponse');\n\nvar MercadoPagoError = require('./utils/mercadopagoError');\n\nvar validation = require('./validation');\n\nvar ETagRequest = require('request-etag');\n\nvar preConditions = require('./precondition');\n\nvar requestManager = module.exports = {\n  JSON_MIME_TYPE: 'application/json',\n  FORM_MIME_TYPE: 'application/x-www-form-urlencoded',\n  REST_CLIENT: new ETagRequest({\n    max: configurations.cache_max_size\n  }, request)\n};\n\nrequestManager.describe = function (options) {\n  // This method will have the context of the class that is calling this (Will have the context of the class)\n  return function () {\n    var optMethod = requestManager.clone({}, options);\n    var calledArgs = arguments;\n    return new Promise(function (resolve, reject) {\n      var callback = calledArgs[calledArgs.length - 1]; // Last argument will always be the callback\n\n      var pathParameters = requestManager.getPathParamsKeyNames(optMethod.path);\n      var missingPayloadProperties = []; // Stores the missing payload path params (if there is any). POST, PUT, PATCH\n\n      var schema = this.schema; // Schema from resource\n\n      var needIdempotency = !!this.idempotency; // Idempotency from resource\n\n      var needPartnersHeaders = !!this.partnersHeaders;\n      var config = {};\n      var payload = {};\n      var error;\n      var totalFunctionParams;\n      var haveConfig = false; // If callback doesn't exists add it to the arguments (Prevent code to fail)\n\n      if (typeof callback !== 'function' || callback === undefined) {\n        // Arguments is not a pure array. You need to make a normal array out of it. If not arguments.length won't work\n        calledArgs = Array.prototype.slice.call(calledArgs);\n        calledArgs.push(callback = function () {});\n      } // If it is GET or DELETE the path variables needs to come from arguments\n\n\n      if (optMethod.method === 'GET' || optMethod.method === 'DELETE') {\n        haveConfig = typeof calledArgs[calledArgs.length - 2] === 'object';\n        totalFunctionParams = haveConfig ? pathParameters.length + 2 : pathParameters.length + 1; // Set the configurations\n\n        if (haveConfig) config = calledArgs[calledArgs.length - 2]; // Verify arguments quantity (invalid function call)\n\n        if (totalFunctionParams > calledArgs.length) {\n          error = new Error('Expecting parameters: ' + pathParameters.join(', ').replace(/:/g, ''));\n          reject(error);\n          return callback.apply(null, [error, null]);\n        } // Replace the path parameters for the variables from the args(same Index that the one declarated on the path)\n\n\n        pathParameters.forEach(function (param, index) {\n          optMethod.path = optMethod.path.replace(param, calledArgs[index]);\n        });\n      } else {\n        haveConfig = calledArgs.length > 2; // If configurations are sent, set configurations and payload depending on the correspondent argument index\n\n        if (haveConfig) {\n          if (typeof calledArgs[calledArgs.length - 2] === 'object') config = calledArgs[calledArgs.length - 2];\n          if (typeof calledArgs[calledArgs.length - 3] === 'object') payload = calledArgs[calledArgs.length - 3];\n        } else if (typeof calledArgs[calledArgs.length - 2] === 'object') {\n          payload = calledArgs[calledArgs.length - 2];\n        } // Replace the path parameters from the ones on the payload\n\n\n        pathParameters.forEach(function (param) {\n          var propertyFromPayload = param.replace(':', '');\n\n          if (payload && payload[propertyFromPayload]) {\n            optMethod.path = optMethod.path.replace(param, payload[propertyFromPayload]); // Remove it from the payload or MercadoPago API will return an error for invalid parameter\n\n            delete payload[propertyFromPayload];\n          } else {\n            missingPayloadProperties.push(propertyFromPayload);\n          }\n        }); // If there are any missing properties show an error (invalid function call)\n\n        if (missingPayloadProperties.length > 0) {\n          error = new Error('The JSON is missing the following properties: ' + missingPayloadProperties.join(', '));\n          reject(error);\n          return callback.apply(null, [error, null]);\n        }\n      } // If the path requires /sandbox prefix on sandbox mode, prepend it\n\n\n      if (optMethod.path_sandbox_prefix !== undefined && optMethod.path_sandbox_prefix && configurations.sandbox) {\n        optMethod.path = '/sandbox' + optMethod.path;\n      } // Generate the AccessToken first (required to work with MercadoPago API)\n\n\n      return requestManager.generateAccessToken().then(function (accessToken) {\n        return requestManager.exec({\n          schema: schema,\n          base_url: optMethod.base_url !== undefined ? optMethod.base_url : '',\n          // Overrides the base URI\n          path: optMethod.path,\n          method: optMethod.method,\n          config: config,\n          // Configurations object\n          payload: payload,\n          // Payload to send\n          idempotency: needIdempotency,\n          // Needs the idempotency header\n          // If the merchant provides an access_token, it should override the access_token configured on init\n          access_token: config.access_token ? config.access_token : accessToken,\n          platformId: needPartnersHeaders && configurations.getPlatformId(),\n          corporationId: needPartnersHeaders && configurations.getCorporationId(),\n          integratorId: needPartnersHeaders && configurations.getIntegratorId()\n        });\n      }).then(function (response) {\n        resolve(response);\n        return callback.apply(null, [null, response]);\n      }).catch(function (err) {\n        reject(err);\n        return callback.apply(null, [err, null]);\n      });\n    }.bind(this));\n  };\n}; // Generate the access_token using the client_id and client_secret\n\n\nrequestManager.generateAccessToken = function (callback) {\n  var error;\n  callback = preConditions.getCallback(callback);\n  return new Promise(function (resolve, reject) {\n    // If the access_token is already set, return it from configurations\n    if (configurations.getAccessToken()) {\n      resolve(configurations.getAccessToken());\n      return callback.apply(null, [null, configurations.getAccessToken()]);\n    } // If the SDK is not yet configure\n\n\n    if (!configurations.getClientId() || !configurations.getClientSecret()) {\n      error = new MercadoPagoError('Must set client_id and client_secret', '', 500, '');\n      reject(error);\n      return callback.apply(null, [error, null]);\n    }\n\n    return requestManager.exec({\n      path: '/oauth/token',\n      method: 'POST',\n      payload: {\n        client_id: configurations.getClientId(),\n        client_secret: configurations.getClientSecret(),\n        grant_type: 'client_credentials'\n      }\n    }).then(function (response) {\n      // Save token on configurations\n      // configurations.setAccessToken(response.body.access_token).setRefreshToken(response.body.refresh_token);\n      resolve(response.body.access_token);\n      return callback.apply(null, [null, response.body.access_token]);\n    }).catch(function (err) {\n      reject(err);\n      return callback.apply(null, [err, null]);\n    });\n  });\n}; // Set the new access_token using the previous one & the refresh_token\n\n\nrequestManager.refreshAccessToken = function (callback) {\n  var error;\n  callback = preConditions.getCallback(callback);\n  return new Promise(function (resolve, reject) {\n    // Check if the refresh token is configure (require to refresh the access_token)\n    if (!configurations.getRefreshToken()) {\n      error = new MercadoPagoError('You need the refresh_token to refresh the access_token', '', 500, '');\n      reject(error);\n      return callback.apply(null, [error, null]);\n    }\n\n    return requestManager.exec({\n      path: '/oauth/token',\n      method: 'POST',\n      payload: {\n        client_secret: configurations.getAccessToken(),\n        grant_type: 'refresh_token'\n      }\n    }).then(function (response) {\n      configurations.setAccessToken(response.body.access_token).setRefreshToken(response.body.refresh_token);\n      resolve(response.body.access_token);\n      return callback.apply(null, [null, response.body.access_token]);\n    }).catch(function (err) {\n      reject(err);\n      return callback.apply(null, [err, null]);\n    });\n  });\n};\n/*\n * Get user access_token (mpconnect) using the access_token, code, redirect_uri\n * @param clientSecret - access_token from MercadoPago\n * @param authorizationCode - authrozication_code obtain from redirectURI\n * @param redirectURI - The one you use for obtaining the authrozication_code\n * @param callback\n */\n\n\nrequestManager.getUserCredentials = function (clientSecret, authorizationCode, redirectURI, callback) {\n  callback = preConditions.getCallback(callback);\n  return new Promise(function (resolve, reject) {\n    return requestManager.exec({\n      path: '/oauth/token',\n      method: 'POST',\n      payload: {\n        client_secret: clientSecret,\n        code: authorizationCode,\n        redirect_uri: redirectURI,\n        grant_type: 'authorization_code'\n      }\n    }).then(function (response) {\n      resolve(response);\n      return callback.apply(null, [null, response]);\n    }).catch(function (err) {\n      reject(err);\n      return callback.apply(null, [err, null]);\n    });\n  });\n};\n/**\n * Build the request using the options send and the configurations\n * @param options\n * @returns {object}\n */\n\n\nrequestManager.buildRequest = function (options) {\n  var req = {};\n  var schemaErrors = [];\n  var headersNames = [];\n  var headerName;\n  var i;\n  var accessToken = options.config && options.config.access_token ? options.config.access_token : options.access_token;\n  req.uri = options.base_url ? options.base_url + options.path : configurations.getBaseUrl() + options.path;\n  req.method = options.method;\n  req.headers = {\n    'user-agent': configurations.getUserAgent(),\n    'x-product-id': configurations.getProductId(),\n    'x-tracking-id': configurations.getTrackingId(),\n    accept: requestManager.JSON_MIME_TYPE,\n    'content-type': requestManager.JSON_MIME_TYPE\n  };\n  req.qs = options.config && options.config.qs ? options.config.qs : {}; // Always set the querystring object\n\n  req.json = true; // Autoparse the response to JSON\n\n  req.headers['Authorization'] = `Bearer ${accessToken}`;\n\n  if (options.integratorId) {\n    req.headers['x-integrator-id'] = options.integratorId;\n  }\n\n  if (options.corporationId) {\n    req.headers['x-corporation-id'] = options.corporationId;\n  }\n\n  if (options.platformId) {\n    req.headers['x-platform-id'] = options.platformId;\n  }\n\n  if (options.config && options.config.headers && typeof options.config.headers === 'object') {\n    headersNames = Object.keys(options.config.headers);\n\n    for (i = 0; i < headersNames.length; i += 1) {\n      headerName = headersNames[i];\n\n      if (headerName !== 'user-agent' && headerName !== 'x-idempotency-key' && Object.prototype.hasOwnProperty.call(options.config.headers, headerName)) {\n        req.headers[headerName] = options.config.headers[headerName];\n      }\n    }\n  }\n\n  if (req.method === 'POST' || req.method === 'PUT' || req.method === 'PATCH') {\n    // Set idempotency header if the resource needs idempotency of the config specified one\n    if (options.idempotency || options.config && options.config.idempotency) {\n      req.headers['x-idempotency-key'] = options.config.idempotency || uuid.v4();\n    }\n\n    if (req.headers['content-type'] === requestManager.JSON_MIME_TYPE) {\n      // If there is a schema available, validate the payload before continue\n      if (options.schema) {\n        schemaErrors = validation.validate(options.schema, options.payload);\n\n        if (schemaErrors.length > 0) {\n          throw new Error(validation.generateErrorMessage(schemaErrors));\n        }\n      }\n\n      req.json = options.payload;\n    } else {\n      req.form = options.payload;\n    }\n  } // Requires SSL certificates be valid\n\n\n  req.strictSSL = true;\n  return req;\n};\n/*\n * Executes the request build with the options sent\n * @param options\n * @param callback\n */\n\n\nrequestManager.exec = function (options, callback) {\n  callback = preConditions.getCallback(callback);\n  return new Promise(function (resolve, reject) {\n    var req;\n    var mpResponse;\n    var mpError;\n\n    try {\n      req = requestManager.buildRequest(options);\n    } catch (e) {\n      reject(e);\n      return callback.apply(null, [e, null]);\n    }\n\n    return requestManager.REST_CLIENT(req, function (error, response, body) {\n      if (error) {\n        // Create a mercadopagoError allowing to retry the operation\n        mpError = new MercadoPagoError(error.message, null, null, req.headers['x-idempotency-key'], options, this);\n        reject(mpError);\n        return callback.apply(null, [mpError, null]);\n      }\n\n      if (response.statusCode < 200 || response.statusCode >= 300 && response.statusCode !== 304) {\n        if (!body) body = {}; // We do this to avoid that we get an error when accessing a body object property. This way body.message would generate undefined.\n        // Create a mercadopagoError allowing to retry the operation\n\n        mpError = new MercadoPagoError(body.message, body.cause, response.statusCode, req.headers['x-idempotency-key'], options, this);\n        reject(mpError);\n        return callback.apply(null, [mpError, null]);\n      } // Create a mercadopagoResponse to be returned\n\n\n      mpResponse = new MercadopagoResponse(body, response.statusCode, req.headers['x-idempotency-key'], body.paging, options, this);\n      resolve(mpResponse);\n      return callback.apply(null, [null, mpResponse]);\n    });\n  }.bind(this));\n};\n/*\n * Get path params key names from a String containing the path. Exp: '/v1/payments/:id' (Generate an array with :id)\n * @param path\n * @returns {Array}\n */\n\n\nrequestManager.getPathParamsKeyNames = function (path) {\n  return path.match(/(:[a-z|A-Z|_|-]*)/g) || [];\n};\n/*\n * Object.assign polyfill\n * @param target\n * @returns {any}\n */\n\n\nrequestManager.clone = function (target) {\n  if (target == null) {\n    // TypeError if undefined or null\n    throw new TypeError('Cannot convert undefined or null to object');\n  }\n\n  var to = Object(target);\n\n  for (var index = 1; index < arguments.length; index++) {\n    var nextSource = arguments[index];\n\n    if (nextSource != null) {\n      // pasamos si es undefined o null\n      for (var nextKey in nextSource) {\n        // Evita un error cuando 'hasOwnProperty' ha sido sobrescrito\n        if (Object.prototype.hasOwnProperty.call(nextSource, nextKey)) {\n          to[nextKey] = nextSource[nextKey];\n        }\n      }\n    }\n  }\n\n  return to;\n};","map":{"version":3,"names":["request","require","Promise","uuid","configurations","MercadopagoResponse","MercadoPagoError","validation","ETagRequest","preConditions","requestManager","module","exports","JSON_MIME_TYPE","FORM_MIME_TYPE","REST_CLIENT","max","cache_max_size","describe","options","optMethod","clone","calledArgs","arguments","resolve","reject","callback","length","pathParameters","getPathParamsKeyNames","path","missingPayloadProperties","schema","needIdempotency","idempotency","needPartnersHeaders","partnersHeaders","config","payload","error","totalFunctionParams","haveConfig","undefined","Array","prototype","slice","call","push","method","Error","join","replace","apply","forEach","param","index","propertyFromPayload","path_sandbox_prefix","sandbox","generateAccessToken","then","accessToken","exec","base_url","access_token","platformId","getPlatformId","corporationId","getCorporationId","integratorId","getIntegratorId","response","catch","err","bind","getCallback","getAccessToken","getClientId","getClientSecret","client_id","client_secret","grant_type","body","refreshAccessToken","getRefreshToken","setAccessToken","setRefreshToken","refresh_token","getUserCredentials","clientSecret","authorizationCode","redirectURI","code","redirect_uri","buildRequest","req","schemaErrors","headersNames","headerName","i","uri","getBaseUrl","headers","getUserAgent","getProductId","getTrackingId","accept","qs","json","Object","keys","hasOwnProperty","v4","validate","generateErrorMessage","form","strictSSL","mpResponse","mpError","e","message","statusCode","cause","paging","match","target","TypeError","to","nextSource","nextKey"],"sources":["C:/Backup/Desktop/LUCAS/henry/PROYECTO FINAL/PF-Rebirth/PF-Rebirth/client/node_modules/mercadopago/lib/request-manager.js"],"sourcesContent":["var request = require('request');\nvar Promise = require('bluebird');\nvar uuid = require('uuid');\nvar configurations = require('./configurations');\nvar MercadopagoResponse = require('./utils/mercadopagoResponse');\nvar MercadoPagoError = require('./utils/mercadopagoError');\nvar validation = require('./validation');\nvar ETagRequest = require('request-etag');\nvar preConditions = require('./precondition');\n\nvar requestManager = module.exports = {\n  JSON_MIME_TYPE: 'application/json',\n  FORM_MIME_TYPE: 'application/x-www-form-urlencoded',\n  REST_CLIENT: new ETagRequest({\n    max: configurations.cache_max_size\n  }, request)\n};\n\nrequestManager.describe = function (options) {\n  // This method will have the context of the class that is calling this (Will have the context of the class)\n  return function () {\n    var optMethod = requestManager.clone({}, options);\n    var calledArgs = arguments;\n\n    return new Promise(function (resolve, reject) {\n      var callback = calledArgs[calledArgs.length - 1]; // Last argument will always be the callback\n      var pathParameters = requestManager.getPathParamsKeyNames(optMethod.path);\n      var missingPayloadProperties = []; // Stores the missing payload path params (if there is any). POST, PUT, PATCH\n      var schema = this.schema; // Schema from resource\n      var needIdempotency = !!this.idempotency; // Idempotency from resource\n      var needPartnersHeaders = !!this.partnersHeaders;\n      var config = {};\n      var payload = {};\n      var error;\n      var totalFunctionParams;\n      var haveConfig = false;\n\n      // If callback doesn't exists add it to the arguments (Prevent code to fail)\n      if (typeof callback !== 'function' || callback === undefined) {\n        // Arguments is not a pure array. You need to make a normal array out of it. If not arguments.length won't work\n        calledArgs = Array.prototype.slice.call(calledArgs);\n        calledArgs.push(callback = function () {});\n      }\n\n      // If it is GET or DELETE the path variables needs to come from arguments\n      if (optMethod.method === 'GET' || optMethod.method === 'DELETE') {\n        haveConfig = (typeof calledArgs[calledArgs.length - 2] === 'object');\n        totalFunctionParams = (haveConfig) ? (pathParameters.length + 2) : (pathParameters.length + 1);\n\n        // Set the configurations\n        if (haveConfig) config = calledArgs[calledArgs.length - 2];\n\n        // Verify arguments quantity (invalid function call)\n        if (totalFunctionParams > calledArgs.length) {\n          error = new Error('Expecting parameters: ' + pathParameters.join(', ').replace(/:/g, ''));\n          reject(error);\n          return callback.apply(null, [error, null]);\n        }\n\n        // Replace the path parameters for the variables from the args(same Index that the one declarated on the path)\n        pathParameters.forEach(function (param, index) {\n          optMethod.path = optMethod.path.replace(param, calledArgs[index]);\n        });\n      } else {\n        haveConfig = (calledArgs.length > 2);\n\n        // If configurations are sent, set configurations and payload depending on the correspondent argument index\n        if (haveConfig) {\n          if (typeof calledArgs[calledArgs.length - 2] === 'object') config = calledArgs[calledArgs.length - 2];\n          if (typeof calledArgs[calledArgs.length - 3] === 'object') payload = calledArgs[calledArgs.length - 3];\n        } else if (typeof calledArgs[calledArgs.length - 2] === 'object') {\n          payload = calledArgs[calledArgs.length - 2];\n        }\n\n        // Replace the path parameters from the ones on the payload\n        pathParameters.forEach(function (param) {\n          var propertyFromPayload = param.replace(':', '');\n\n          if (payload && payload[propertyFromPayload]) {\n            optMethod.path = optMethod.path.replace(param, payload[propertyFromPayload]);\n            // Remove it from the payload or MercadoPago API will return an error for invalid parameter\n            delete payload[propertyFromPayload];\n          } else {\n            missingPayloadProperties.push(propertyFromPayload);\n          }\n        });\n\n        // If there are any missing properties show an error (invalid function call)\n        if (missingPayloadProperties.length > 0) {\n          error = new Error('The JSON is missing the following properties: ' + missingPayloadProperties.join(', '));\n          reject(error);\n          return callback.apply(null, [error, null]);\n        }\n      }\n\n      // If the path requires /sandbox prefix on sandbox mode, prepend it\n      if (optMethod.path_sandbox_prefix !== undefined && optMethod.path_sandbox_prefix && configurations.sandbox) {\n        optMethod.path = '/sandbox' + optMethod.path;\n      }\n\n      // Generate the AccessToken first (required to work with MercadoPago API)\n      return requestManager.generateAccessToken().then(function (accessToken) {\n        return requestManager.exec({\n          schema: schema,\n          base_url: (optMethod.base_url !== undefined) ? optMethod.base_url : '', // Overrides the base URI\n          path: optMethod.path,\n          method: optMethod.method,\n          config: config, // Configurations object\n          payload: payload, // Payload to send\n          idempotency: needIdempotency, // Needs the idempotency header\n          // If the merchant provides an access_token, it should override the access_token configured on init\n          access_token: config.access_token ? config.access_token : accessToken,\n          platformId: needPartnersHeaders && configurations.getPlatformId(),\n          corporationId: needPartnersHeaders && configurations.getCorporationId(),\n          integratorId: needPartnersHeaders && configurations.getIntegratorId(),\n        });\n      }).then(function (response) {\n        resolve(response);\n        return callback.apply(null, [null, response]);\n      }).catch(function (err) {\n        reject(err);\n        return callback.apply(null, [err, null]);\n      });\n    }.bind(this));\n  };\n};\n\n// Generate the access_token using the client_id and client_secret\n\nrequestManager.generateAccessToken = function (callback) {\n  var error;\n\n  callback = preConditions.getCallback(callback);\n\n  return new Promise(function (resolve, reject) {\n    // If the access_token is already set, return it from configurations\n    if (configurations.getAccessToken()) {\n      resolve(configurations.getAccessToken());\n      return callback.apply(null, [null, configurations.getAccessToken()]);\n    }\n\n    // If the SDK is not yet configure\n    if (!configurations.getClientId() || !configurations.getClientSecret()) {\n      error = new MercadoPagoError('Must set client_id and client_secret', '', 500, '');\n      reject(error);\n      return callback.apply(null, [error, null]);\n    }\n\n    return requestManager.exec({\n      path: '/oauth/token',\n      method: 'POST',\n      payload: {\n        client_id: configurations.getClientId(),\n        client_secret: configurations.getClientSecret(),\n        grant_type: 'client_credentials'\n      }\n    }).then(function (response) {\n      // Save token on configurations\n      // configurations.setAccessToken(response.body.access_token).setRefreshToken(response.body.refresh_token);\n\n      resolve(response.body.access_token);\n      return callback.apply(null, [null, response.body.access_token]);\n    }).catch(function (err) {\n      reject(err);\n      return callback.apply(null, [err, null]);\n    });\n  });\n};\n\n// Set the new access_token using the previous one & the refresh_token\n\nrequestManager.refreshAccessToken = function (callback) {\n  var error;\n\n  callback = preConditions.getCallback(callback);\n\n  return new Promise(function (resolve, reject) {\n    // Check if the refresh token is configure (require to refresh the access_token)\n    if (!configurations.getRefreshToken()) {\n      error = new MercadoPagoError('You need the refresh_token to refresh the access_token', '', 500, '');\n      reject(error);\n      return callback.apply(null, [error, null]);\n    }\n\n    return requestManager.exec({\n      path: '/oauth/token',\n      method: 'POST',\n      payload: {\n        client_secret: configurations.getAccessToken(),\n        grant_type: 'refresh_token'\n      }\n    }).then(function (response) {\n      configurations.setAccessToken(response.body.access_token)\n        .setRefreshToken(response.body.refresh_token);\n\n      resolve(response.body.access_token);\n      return callback.apply(null, [null, response.body.access_token]);\n    }).catch(function (err) {\n      reject(err);\n      return callback.apply(null, [err, null]);\n    });\n  });\n};\n\n/*\n * Get user access_token (mpconnect) using the access_token, code, redirect_uri\n * @param clientSecret - access_token from MercadoPago\n * @param authorizationCode - authrozication_code obtain from redirectURI\n * @param redirectURI - The one you use for obtaining the authrozication_code\n * @param callback\n */\nrequestManager.getUserCredentials = function (clientSecret, authorizationCode, redirectURI, callback) {\n  callback = preConditions.getCallback(callback);\n\n  return new Promise(function (resolve, reject) {\n    return requestManager.exec({\n      path: '/oauth/token',\n      method: 'POST',\n      payload: {\n        client_secret: clientSecret,\n        code: authorizationCode,\n        redirect_uri: redirectURI,\n        grant_type: 'authorization_code'\n      }\n    }).then(function (response) {\n      resolve(response);\n      return callback.apply(null, [null, response]);\n    }).catch(function (err) {\n      reject(err);\n      return callback.apply(null, [err, null]);\n    });\n  });\n};\n\n/**\n * Build the request using the options send and the configurations\n * @param options\n * @returns {object}\n */\nrequestManager.buildRequest = function (options) {\n  var req = {};\n  var schemaErrors = [];\n  var headersNames = [];\n  var headerName;\n  var i;\n  var accessToken = ((options.config && options.config.access_token) ? options.config.access_token : options.access_token);\n\n  req.uri = (options.base_url) ? options.base_url + options.path : configurations.getBaseUrl() + options.path;\n  req.method = options.method;\n  req.headers = {\n    'user-agent': configurations.getUserAgent(),\n    'x-product-id': configurations.getProductId(),\n    'x-tracking-id': configurations.getTrackingId(),\n    accept: requestManager.JSON_MIME_TYPE,\n    'content-type': requestManager.JSON_MIME_TYPE\n  };\n  req.qs = (options.config && options.config.qs) ? options.config.qs : {}; // Always set the querystring object\n  req.json = true; // Autoparse the response to JSON\n\n\n  req.headers['Authorization'] = `Bearer ${accessToken}`;\n\n  if(options.integratorId) {\n    req.headers['x-integrator-id'] = options.integratorId;\n  }\n\n  if(options.corporationId) {\n    req.headers['x-corporation-id'] = options.corporationId;\n  }\n\n  if(options.platformId) {\n    req.headers['x-platform-id'] = options.platformId;\n  }\n\n  if (options.config && options.config.headers && typeof options.config.headers === 'object') {\n    headersNames = Object.keys(options.config.headers);\n    for (i = 0; i < headersNames.length; i += 1) {\n      headerName = headersNames[i];\n      if (headerName !== 'user-agent' && headerName !== 'x-idempotency-key'\n        && Object.prototype.hasOwnProperty.call(options.config.headers, headerName)) {\n        req.headers[headerName] = options.config.headers[headerName];\n      }\n    }\n  }\n\n  if (req.method === 'POST' || req.method === 'PUT' || req.method === 'PATCH') {\n    // Set idempotency header if the resource needs idempotency of the config specified one\n    if (options.idempotency || (options.config && options.config.idempotency)) {\n      req.headers['x-idempotency-key'] = options.config.idempotency || uuid.v4();\n    }\n    if (req.headers['content-type'] === requestManager.JSON_MIME_TYPE) {\n      // If there is a schema available, validate the payload before continue\n      if (options.schema) {\n        schemaErrors = validation.validate(options.schema, options.payload);\n\n        if (schemaErrors.length > 0) {\n          throw new Error(validation.generateErrorMessage(schemaErrors));\n        }\n      }\n\n      req.json = options.payload;\n    } else {\n      req.form = options.payload;\n    }\n  }\n\n  // Requires SSL certificates be valid\n  req.strictSSL = true;\n\n  return req;\n};\n\n/*\n * Executes the request build with the options sent\n * @param options\n * @param callback\n */\nrequestManager.exec = function (options, callback) {\n  callback = preConditions.getCallback(callback);\n\n  return new Promise(function (resolve, reject) {\n    var req;\n    var mpResponse;\n    var mpError;\n\n    try {\n      req = requestManager.buildRequest(options);\n    } catch (e) {\n      reject(e);\n      return callback.apply(null, [e, null]);\n    }\n\n    return requestManager.REST_CLIENT(req, function (error, response, body) {\n      if (error) {\n        // Create a mercadopagoError allowing to retry the operation\n        mpError = new MercadoPagoError(error.message, null, null, req.headers['x-idempotency-key'], options, this);\n        reject(mpError);\n        return callback.apply(null, [mpError, null]);\n      }\n\n      if (response.statusCode < 200 || (response.statusCode >= 300 && response.statusCode !== 304)) {\n        if (!body) body = {}; // We do this to avoid that we get an error when accessing a body object property. This way body.message would generate undefined.\n        // Create a mercadopagoError allowing to retry the operation\n        mpError = new MercadoPagoError(body.message, body.cause, response.statusCode, req.headers['x-idempotency-key'],\n          options, this);\n        reject(mpError);\n        return callback.apply(null, [mpError, null]);\n      }\n\n      // Create a mercadopagoResponse to be returned\n      mpResponse = new MercadopagoResponse(body, response.statusCode, req.headers['x-idempotency-key'],\n        body.paging, options, this);\n\n      resolve(mpResponse);\n      return callback.apply(null, [null, mpResponse]);\n    });\n  }.bind(this));\n};\n\n/*\n * Get path params key names from a String containing the path. Exp: '/v1/payments/:id' (Generate an array with :id)\n * @param path\n * @returns {Array}\n */\nrequestManager.getPathParamsKeyNames = function (path) {\n  return path.match(/(:[a-z|A-Z|_|-]*)/g) || [];\n};\n\n/*\n * Object.assign polyfill\n * @param target\n * @returns {any}\n */\nrequestManager.clone = function (target) {\n  if (target == null) { // TypeError if undefined or null\n    throw new TypeError('Cannot convert undefined or null to object');\n  }\n\n  var to = Object(target);\n\n  for (var index = 1; index < arguments.length; index++) {\n    var nextSource = arguments[index];\n\n    if (nextSource != null) { // pasamos si es undefined o null\n      for (var nextKey in nextSource) {\n        // Evita un error cuando 'hasOwnProperty' ha sido sobrescrito\n        if (Object.prototype.hasOwnProperty.call(nextSource, nextKey)) {\n          to[nextKey] = nextSource[nextKey];\n        }\n      }\n    }\n  }\n  return to;\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}